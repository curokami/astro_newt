---
import Layout from "../../layouts/Layout.astro";
import { getArticlesByTag, getTags } from "../../lib/newt.ts";

// âœ… è¿½åŠ : getStaticPaths ã‚’å®šç¾©ã—ã¦ã€ã™ã¹ã¦ã®ã‚¿ã‚°ã®ãƒ‘ã‚¹ã‚’äº‹å‰ã«ç”Ÿæˆ
export async function getStaticPaths() {
  const tags = await getTags();
  return tags.map(tag => ({
    params: { slug: tag.slug },
    props: { tag },
  }));
}

const { slug } = Astro.params;
console.log("ğŸš€ å–å¾—ã—ãŸã‚¿ã‚°:", slug); // âœ… ãƒ‡ãƒãƒƒã‚°ç”¨

const { tag, articles } = await getArticlesByTag(slug);
---

<Layout title={tag?.name || "ã‚¿ã‚°"} description={`ã€Œ${tag?.name || "ã‚¿ã‚°"}ã€ã«é–¢é€£ã™ã‚‹è¨˜äº‹ä¸€è¦§`}>
  <h1 class="title">ã€Œ{tag?.name || "ã‚¿ã‚°"}ã€ã®æŠ•ç¨¿</h1>
  <ul class="articles">
    {articles.length > 0 ? (
      articles.map(article => (
        <li class="card">
          <a href={`/blog/${article.slug}/`}>
            <img src={article.coverImage?.src} alt={article.title} class="card-img" />
            <div class="card-title">{article.title}</div>
          </a>
        </li>
      ))
    ) : (
      <p>è¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“</p>
    )}
  </ul>
</Layout>